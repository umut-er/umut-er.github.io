[
  
  {
    "title": "My Contributions to the Newt Project Part 2",
    "url": "/posts/my-contributions-to-the-newt-project-part-2/",
    "categories": "",
    "tags": "gsoc",
    "date": "2024-08-01 14:50:00 +0300",
    





    
    "snippet": "IntroductionThis is the second part of my blog post logging the contributions I made to the Newt project. You can see that post here. This blog post will go mostly into the contributions I made aft...",
    "content": "IntroductionThis is the second part of my blog post logging the contributions I made to the Newt project. You can see that post here. This blog post will go mostly into the contributions I made after the work I outlined in the first blog even though there might be some overlap. Let’s go through it:Small Bug FixesGitHub Issue There was a small bug related to loading maps on top of each other when they had certain color schemes. I found this bug and resolved it.GitHub Issue There was a small bug related to a spinner (which is a small animation indicating a load screen) that appears if we try to apply layout an empty map. This was a nice and easy fix.`Added at the time of the edit, 13th of August GitHub Issue There was a small issue with the SBGN bricks feature, which, as the name suggests, should only work with SBGN formats (specifically, PD). However, it worked with SBML also, which is not intended. I disabled this behaviour.Build BoxGithub Issue This was a suggestion by me. In web development, it is usual to have an internal server (meaning only the people working in a company have access to that server). This server occasionally gets rebuilt (which means updated with the latest changes). In our team, there was some confusion about when this server was last updated, what changes are currently on the internal server ready to be tested, etc… I suggested to include a build box that included the time of the last rebuild of the internal server. It looks like this:as you can see, in the blue portion in the middle, we have the build information.File Loading ImprovementsGitHub Issue I made two suggestions to include in the next Newt release. First one is including the spinner when we are trying to import very large files.The second one is related to the drag &amp; drop import operation. This operation previously only worked for a limited number of file formats. For the other file formats, we had to use the import menu. I added functionality so that we don’t have to use the import menu and just use the drag &amp; drop functionality. This issue was mostly resolved, but there were some concerns related to code duplication (which is when we write code that solves the same problem in different parts of the software). The remaining part of the issue was taken out of the release milestone, which just means it will be revisited in a later time.SBML UI, Palette and Legend ImprovementsGitHub Issue It was found that there were significant issues with the SBML (which is a file format) support in Newt. Couple of issues were opened about these problems, one of which is this one. This one is generally about visual enhancements for the users. It included six items to be fixed, to which I also added one. Resolving this issue was a relatively long process, which involved careful frontend work. After a lot of back and forth trying to understand and resolved the issues, we managed to completely fix this issue.I also suggested a visual update of labeling the nodes / edges in the palette. Below, you can see the old (top) and the new (bottom) imagesImport / Export Operation ImprovementsGitHub Issue I was originally not going to do this, but I was included anyway. This is the largest standing issue on this project since I have started my work. A complicated issue that encompasses a wide variety of functionalities that need to be fixed.Let me try to explain what this is. There are many file formats for doing systems biology. I went over this concept in my previous blog post. These formats can sometimes be converted to each other. In Newt, we have support for this type of functionality whenever it is possible. However, we don’t do all of this ourselves. Sometimes, we use external services to do our converting. The aim is getting a file which represents the model you have on the screen. This is broadly called exporting. Some issues were discovered with these processes.The reverse, loading an exported file into the app, is called importing. Some issues were also discovered with the import process.The biggest issue here was that we were not exporting nor importing layout information (which is related to how we show a biochemical map to our users, what goes where etc…) when we are working with the SBML file format. I was included to fix the export side of this issue. In order to learn how these formats work (by extension learning how they might be exported), you need to read technical documents called specifications. Now, those of you that are not familiar to documentations and specifications might not be aware of this, but those documents are usually long and dense. This is the SBML Level 3 Version 2 Specifications, which is 180+ pages long. The good news is that we don’t have to read all of it. We try to only read what is relevant to us (which is usually not very straightforward to determine). There are also good software packages that help us in the process. Luckily, this was the case. Even though this issue is still ongoing at the time of writing (but almost resolved at the time of the edit, -UUE), we have made major progress. I have also upgraded our app to use SBML Level 3 Version 2, which is a more thorough standard for what we want to achieve (it is also the latest).At the time of the edit, I was tasked with and resolved more items on this issue, which included a PD to SBML (and vice versa) conversion using the MINERVA service. I also implemented something called infer nesting for SBML, which is a graph algorithm to put smaller nodes inside bigger nodes.Auxiliary Box / State Information in Export / ImportGitHub Issue, GitHub Issue I have already talked about SBML export / import, which is also what the focus of this issue is. In our interpretation of the SBML format, following CellDesigner, we have auxiliary boxes. See the marked regions in the image below.These are the binding region, residue variable and the unit of information. There is also something called state information for nodes. See picture below:these are the multimer node, the active node and the hypothetical node (in that order, left to right). These information were not exported previously. I was tasked to export and import them.Now, there is a reason why I said that this was our interpretation of the SBML format. That’s because the SBML format is not exact with regards to what visual features we put on the screen. Visually representing a biochemical map is only a secondary concern with SBML. It is more concerned with the integrity of the underlying model which consists of species and reactions (broadly). The format is designed for a machine to understand and simulate whereas something like the SBGN format is designed not to simulate but to show the user what the biological model is.Why have I explained all this? Well, I want to express that there is not an exact way of storing this visual information in the SBML format even though Newt has these SBML features, which is fine. As I said, it is not an exact standard with respect to the visual features. Luckily, the people who develop this SBML format are smart people and recognize that individual softwares might want to go above and beyond what the intention of a pure SBML file would be. They include a way of annotating elements through the &lt;annotation&gt; tag. The contents of this tag can freely ignored by other software packages, which means it includes non-essential software specific information about the underlying model. This is exactly what I am trying to do with this issue.With all that out of the way, I started working on our annotation scheme. It has some rules outlined in that 180+ page document, but it is not very limiting at all (basically any valid XML with a namespace goes). I developed our format for this and implemented export / import functionality for our software. As of the writing of this blog, this issue is awaitig to be reviewed and closed (it is closed at the time of edit, -UUE).Conclusion / Future WorkWell, this was a good amount of work that I outlined. When reading through the SBML documentation, I realized that the most important feature of the SBML format is producing simulations for biochemical reactions. However, there is currently no support for this in Newt. I talked to my mentor and we agreed to talk about this after the release because it would be a long process and delay the release unnecessarily.At the time of edit, 13th of August, I have prepared a document for SBML simulation support and sent it to my mentor. I expect that the new Newt release will come sometime this month.At the time of second edit, 20th of August, we decided to move forward with the simulation features as outlined in the document. I expect that I will be working to add that feature over the course of the semester, but we will see.This blog also has more readers than I anticipated initially (Which is admittedly 0. I opened this blog mostly for documenting my work, though I am planning on expanding my scope to talk about books, mathematics or other stuff). I might add a mailing list for people who are interested in being notified when my blogs come out. I might also share an Instagram story about my blog. We will see. Definitely let me know if you are interested in a mailing list (If you are reading this, you can probably access me on either Instagram or Whatsapp).Have a lovely rest of the summer!"
  },
  
  {
    "title": "My Contributions to the Newt Project",
    "url": "/posts/my-contributions-to-the-newt-project/",
    "categories": "",
    "tags": "gsoc",
    "date": "2024-07-01 17:10:00 +0300",
    





    
    "snippet": "IntroductionSo, I have been working on the Newt project (which is a project about what is usually called “systems biology”, especially visualizing biological pathways) for about three weeks (not co...",
    "content": "IntroductionSo, I have been working on the Newt project (which is a project about what is usually called “systems biology”, especially visualizing biological pathways) for about three weeks (not counting Eid). I will go through my contributions in chronological order below.Added at the time of the edit, 20th of August Part 2 is out. You can view it here. If you are viewing this as part of GSOC final submission, you should know that part 2 also covers my work during the program. Nothing else in this blog, except those two blog posts, is part of my submission. I provide the links to specific GitHub issues in both blog posts, from which you can view the code. The issues are going to be incorporated into the upcoming Newt 4.0 release.Creating an SBML LegendGitHub Issue A “legend” is defined as the wording on a map or diagram explaining the symbols used for those of you who are not familiar with that sense of the word. SBML stands for Systems Biology Markup Language which is linked with something called CellDesigner. None of these are terribly important for you to know fully. Here is a quick explanation:SBML is a way to define and show biochemical reactions with certain signs such that there is very little confusion about the meaning of the symbols. A legend is a document (briefly) explaining these symbols and their meanings. Here is the official CellDesigner legend:.I was tasked with making a similar legend and integrating it to the application. I came up with this:This was then integrated into the application. It now looks like this:                                                              Your browser does not support the video tag. Here is a    link to the video file instead.    Overall, I would say that this was a relatively simple although somewhat time consuming task since I had to create this image using inkscape, which was not something I was familiar with.Query HighlightingGitHub Issue There exists a database called PathwayCommons which contains a lot of biological pathways and interactions (mainly between genes). These database services have what’s called an API (stands for Application Programming Interface). What an API allows us to do is asking these services some data (in this case, it is giving us information about pathways). In Newt, there is an interface which allows us to make API requests (that is, asking a web service for some information) and display the result in a user friendly way. Here is a demonstratiton (warning: most of this video is the load screen, feel free to move to the 20s-25s mark):                                                              Your browser does not support the video tag. Here is a    link to the video file instead.    I was tasked with color coding this output so that it is more clear what is going on. I will skip over the details of how I did it (and causing a temporary crash on the internal server…) and just show you the result. Below is what comes out after the same query in the video:There are also more colorful queries, especially ones with both source and target nodes (understanding these terms are not relevant). Here is another picture (this one is a more complicated query between BRCA1 and BRCA2):Underlay HighlightingGitHub Issue Well, in order to show the previous one, I had to show you this one as well, so, brief let me be. Newt originally had a highlight feature. It looked like this:After my implementations, it looks like this:This is a better highlighter for a couple of reasons:  It is visually more appealing and apparent.  It doesn’t interfere with situations where the color of the edges have significance.Map Type Display on TabsGitHub Issue We already talked about how we represent maps with symbols and legends. However, people have come up with different sets of symbols and legends over the years. Newt currently implements PD (process description), AF (activity flow), SIF (simple interaction format), SBML (systems biology markup language) and a combination of these. Every image that I can generate has uses at least one (possibly a combination of) the symbols of these dialects. This is called the “type” of the map. Previously, we could see the type of the map from the sidebar:After my visual changes, this is now how it looks (pay extra attention to the blue parts in the previous picture):As you can see, there is some visual change in the blue marked parts (marked in the previous picture). First of all, the map type is now shown on the tabs on the bottom right. Also, there is now a shadow effect on the tabs (in both blue marked places). This is technically called a box-shadow, which enhances the visuals.About Some Small BugsGitHub Issue A bug is defined as an error in a computer program or system. During my time working on the Newt project, I also found some issues with the works of other people working there. I don’t want to go into details, suffice it to say that there was some weird behavior with a pop-up panel. I pointed this out and also helped in implementing the ideal behavior for smoother user experience.GitHub Issue There was a small issue related to map loading that I fixed as well.Query Result SimplificationGitHub Issue Remember this picture?Well, there is a problem. It’s big. It’s huge. It contains a lot of excess information. So, there was an idea on simplifying some of these extra bits of pieces. We do that by removing the nodes that we see as excess. We developed an algorithm (defined as a process or set of rules to be followed in calculations) on how to select what goes and what remains. The algorithm is a bit complicated to explain in this post, but ultimately not very complicated at all. What you should know is that the way we decide is not random. The things that go have to satisfy a certain level of simplicity (meaning that nothing complicated is lost). Without further yapping, let me present you with the simplified version of the same query:still complicated, but noticably simpler. Here is an extra picture on the nodes that we decide to delete with this algorithm (anything that is highlighted in blue means that it is going away):Closing RemarksHope this was a fun and easy read! I tried to make this piece as accessible as I can for the general public, which is not how I wrote the first two more technical posts. Anyhow, these document my changes (as of the date of publication) which is contained in the GitHub record in 7-8 issues and 2-3 pull requests. I think this was a productive couple of weeks for me, and my mentor seems to like my work as well. Currently I am reading about computer algebra, which is a computational/mathematical theory about making a computer solve mathematical problems (such as integration, think WolframAlpha if you are familiar with that). It’s a struggle… But maybe in the future (very future) a blog post about that may come out. Also, I included a Hamlet quotation in this post. Can you figure that out?"
  },
  
  {
    "title": "Running Newt on My Locale",
    "url": "/posts/running-newt-on-my-locale/",
    "categories": "",
    "tags": "gsoc",
    "date": "2024-06-03 17:00:00 +0300",
    





    
    "snippet": "IntroductionToday, I was able to get Newt working on my local computer, which is certainly an important step. I mentioned in my proposal that there were a lot of dependency conflicts between certai...",
    "content": "IntroductionToday, I was able to get Newt working on my local computer, which is certainly an important step. I mentioned in my proposal that there were a lot of dependency conflicts between certain parts of the project. Here, I go over more problems I encountered.Dependency ConflictsIn my proposal, I talked about the fact that most of the dependency conflicts were related to the forked cytoscape.js project, which I talked about in my first blog post. Quick reminder: The forked cytoscape.js project is below version 3.3.0, while certain extensions require a cytoscape.js that is above version 3.3.0. To understand the extent of the dependency conflict, I tried a temporary fix. I went to the cytoscape.js fork and, without altering anything else, changed its version number.This was not the only change I had to make though. I added the following:\"overrides\": {    \"graceful-fs\": \"^4.2.11\"  }to the package.json of sbgnviz.js. The reason is related to some conflict related to gulp. To go into more detail, please review this stackoverflow post. Also, I had to update the jquery versions in sbgnviz.js and chise.js from ^2.2.4 to ^3.3.1. After these dependency updates, I was able to run Newt on my local computer without any issues.This might not be an “honest” solution, because there was no merging changes from cytoscape.js 3.3.0. I am certainly planning to look at that as well now that I feel like I understand the project better. However, this shows that there are going to be no further issues related to dependency conflicts after these.sbgn.js (1)When I said “I was able to run Newt on my local computer without any issues,” I lied. There is one more, which is related to the sbgn.isActive() method I was talking about in my previous blog post. This method is nowhere to be found. Even when I ran the entire application (The stack looks something like cytoscape.js -&gt; sbgnviz.js -&gt; chise.js -&gt; Newt, however, the lower down projects are not necessarily independent of the projects utilizing them. For example, cytoscape.js cannot be used without sbgnviz.js), this method was not declared anywhere. I added a temporary fix, see below:// Temporary$$.sbgn.isActive = function (node) {    return false;}to sbgn-cy-renderer.js in sbgnviz.js, which seems to work just fine for now. Tracking this issue further, the active note stuff seems to be relatively recent. See the following git logs:commit 174418c24bec5e77d104e52352ee8fb39b2305c5 (origin/SBML)Author: Selbi Ereshova &lt;selbi.ereshova@ug.bilkent.edu.tr&gt;Date:   Wed Jul 27 15:06:43 2022 +0300    Added isActive backcommit 87a417d549e3b5b794ed0333e198b79a02525ab2Author: Selbi Ereshova &lt;selbi.ereshova@ug.bilkent.edu.tr&gt;Date:   Tue Jul 5 11:13:50 2022 +0300    Active node supportedcommit d3fbf19906020d497f230168714247ac9f3f497fAuthor: Selbi Ereshova &lt;selbi.ereshova@ug.bilkent.edu.tr&gt;Date:   Mon Jul 4 14:28:24 2022 +0300    Removed isActive check for nowcommit 4b82f842598dd3c55e6c142269a45f4f70e7b37eAuthor: Selbi Ereshova &lt;selbi.ereshova@ug.bilkent.edu.tr&gt;Date:   Thu Jun 30 18:15:21 2022 +0300    Recreated dist files        Recreated dist files after adding support for active node typecommit 8eb065dd892b9397f9970268d9f4cd3aa8ee3939Author: Selbi Ereshova &lt;selbi.ereshova@ug.bilkent.edu.tr&gt;Date:   Thu Jun 30 15:38:14 2022 +0300    documented new change        documented new change: \"active node support\"These commits are the ones just before I started working on this project (in terms of commits, not time). Inspecting the mail address, it seems that these commits are made by an undergraduate student, Selbi Ereshova, as part of another GSoC project. These were in 2022. I don’t know what happened to isActive() between then and now.sbgn.js (2)I mentioned in my previous post that I wanted to move sbgn implementations from sbgnviz.js to cytoscape.js. This turned out to be harder than expected. I think this is because of a cyclic dependency between node-shapes.js and sbgn.js. I have no idea how to solve this, or how moving these implementations to sbgnviz.js solves this issue. I have, in the commit history of my fork of cytoscape.js, a commit where I moved all the sbgn implementations. I am not able to use this as a normal cytoscape.js version, possibly because of the said cyclic dependency issue. This will be something I will be investigating in the future for sure.ConclusionI have detected some of the issues that were troubling me and found solutions to some of them. In the blog post I went over some of the things I am thinking about doing in the future. I am getting more familiar with the codebase, which is certainly going to be very helpful in the future."
  },
  
  {
    "title": "Initial Observations on Newt's Backend",
    "url": "/posts/initial-observations-on-newt's-backend/",
    "categories": "",
    "tags": "gsoc",
    "date": "2024-05-24 23:47:00 +0300",
    





    
    "snippet": "IntroductionAs a first step into my work, I am trying to understand how ivis-cytoscape and sbgnviz extend the functionality of the original cytoscape project. I will now try to explain what these e...",
    "content": "IntroductionAs a first step into my work, I am trying to understand how ivis-cytoscape and sbgnviz extend the functionality of the original cytoscape project. I will now try to explain what these extensions are, what they do and why they do what they do.Just a heads up, the information here might not be accurate / outdated. Please take a look at the documentation / the source code for yourself to confirm if anything looks wrong.MotivationCytoscape.js is a well rounded project for many use cases. Many companies / projects have been using this project for many reasons (you can see some of them here). However, if a project is good for a very broad scenarios, it is very often the case that for very specific scenarios it needs to be extended to fit particular needs. This is the case here. See the picture below:  This is taken from this page. These symbols are the ones used in SBGN Process Description notation. These would be what we want to use as nodes / edges in Newt. However, in order to use these, we need specialized ways to render these symbols and the interactions between objects of these types. This is the motivation of the extension of cytoscape.js.How It Is DoneIn this section I will explain how the original cytoscape.js got extended.What Can the Original Do?Let’s first of all note what cytoscape.js can do in order to talk about what it can’t do / how it is extended. By default, cytoscape.js seems to support a lot of shapes, here are some examples:  Polygon (more on this later!)  Ellipse  Round Rectangle  Cut Rectangle  Barrel  Bottom Round Rectangle  …See this for all possibilities. In the source code, these shapes are defined in the /src/core/extensions/renderer/base/node-shapes.js file. If we look carefully in the source code, we can see that there are only six “drawing strategies”, which are the ones listed above. The last five are pretty straight-forward, but there is more to Polygon than meets the eye. Below is a sample from the source code:BRp.generatePolygon = function( name, points ){  return ( this.nodeShapes[ name ] = {    renderer: this,    name: name,    points: points,    draw: function( context, centerX, centerY, width, height ){      this.renderer.nodeShapeImpl( 'polygon', context, centerX, centerY, width, height, this.points );    },    intersectLine: function( nodeX, nodeY, width, height, x, y, padding ){      return math.polygonIntersectLine(          x, y,          this.points,          nodeX,          nodeY,          width / 2, height / 2,          padding )        ;    },    checkPoint: function( x, y, padding, width, height, centerX, centerY ){      return math.pointInsidePolygon( x, y, this.points,        centerX, centerY, width, height, [0, -1], padding )      ;    }  } );};Polygon is defined as an array of points on the unit square (defined as \\([-1,1] \\times [-1,1]\\)) which are connected one by one (i.e. p1 connects to p2, p2 connects to p3…). All other shapes are defined using the Polygon drawing strategy (for example, the rhombus). As you can see in the source code, the generatePolygon() function returns an object which has a draw function which uses the ‘polygon’ drawing strategy. Keep this in mind for the following section.The Problem / The SolutionAn important (and limiting) feature of the polygon drawing strategy is that there is no way of defining arcs between points. The other drawing strategies are too specific to be used elsewhere, too. So, the problem is that there is no way we can get the shapes we want doing limited modifications / additions to the source code. A complicating factor is that many of these are compound shapes, meaning they contain more than one shape.The way that this issue got resolved is somewhat interesting. The first step is relatively straightforward. We register our new types (which are source and sink, nucleic acid feature, complex, macromolecule, simple chemical, biological activity and compartment) into the base cytoscape.js system. Then, we create wrapper functions called nodeFcnCaller.draw(), nodeFcnCaller.intersectLine() and nodeFcnCaller.checkPoint() (See the source code above, exactly the same three functions which are returned from this function!). We modify the source code such that any time we want to call the regular draw(), intersectLine() or checkPoint() methods, we call the wrapper instead. The wrapper functions check that whether these are sbgn shapes, and if they are, calls a different function (which takes in something called an imgObj, see cy-modifications.txt) to deal with that case.I then investigated where these shapes and their methods are defined. And I found … nothing. All clues pointed to src/sbgn.js, which was just an empty file with a comment:// sbgn shapes not supported by cytoscape.js this object will be exposed in cytoscape.js// and will be filled in sbgnviz.js// TODO: consider filling this object here and remove related things from sbgnvizUpon reading this, I investigated sbgnviz.js. From what I gathered, it seems to function as a frontend to this cytoscape.js fork, allowing it to work with higher level sbgn representations, such as sbgnml (stands for sbgn markup language).What is relevant to us, however, understanding that sbgnviz.js fills in these required functionalities (such as defining sbgn types). This is problematic for the following reasons. Without these functions, this cytoscape.js fork cannot function as a standalone project and always has to be used in conjunction with sbgnviz.js. Another issue is that it is impossible to test some features of the base project, which is what I encountered when I first ran the tests. For this reason, I agreed with the developer who wrote the TODO, and tried to actually do it. I found the required functions and their implementations in this file and moved them over to sbgn.js.Closing Remarks / Future WorkI would say that the small amount of work I did was relatively successful, and I felt like I learned a lot about the backend of the project. One thing that I am yet to figure out is something called sbgn.isActive(node), which is required in some places (see first code sample below), but is not actually in the sbgn-cy-renderer.js file. I added a temporary function with the same name that always returns false (until I figure out what it actually is), and I am happy to report that the fork actually passes all 514 tests! However, I don’t think there are specific tests for the sbgn features, which one might in the future look to add.~/projects/clones/cytoscape.js (unstable ✔) jsgrep \"isActive\"./src/collection/dimensions/bounds.js:469:      if(sbgn.isActive(ele)) {./src/sbgn.js:1370:sbgn.isActive = function(node) {Note: jsgrep is a alias around the grep command that I came up with to speed up my investigation of these huge repositories. It excludes ./dist, ./documentation and ./node_modules. If you are interested, add the snippet below to your terminal source file:# javascript project grep commandjsgrep(){\tgrep --color=auto -r -n $1 --exclude-dir=\"./node_modules\" --exclude-dir=\"./dist\" --exclude-dir=\"./documentation\" --exclude-dir={.bzr,CVS,.git,.hg,.svn,.idea,.tox}}"
  }
  
]

